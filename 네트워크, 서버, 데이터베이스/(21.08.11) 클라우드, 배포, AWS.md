# 배포

***

## 클라우드 컴퓨팅

### 1. 온프레미스 (기존 방식)
- 온프레미스 
  - 자체적으로 보유한 전산실 서버에 직접 설치해 운영하는 방식

  - 전산실 등에 컴퓨터를 배치하고 인터넷을 연결하여 서비스 제공하고, 대기업은 데이터 센터 보유

  - 서버의 한계가 오면 성능 개선 또는 컴퓨터 추가

- 장점 : 데이터를 직접 소유하며 보안 문제를 직접 다룰 수 있음 (정부기관, 은행 등에서는 온프레미스 선호)

- 단점
  - 주기적인 관리가 필요하고 관리해야 하는 컴퓨터가 많아지면 비용 커지며 공간의 한계가 있음
  - 초기 비용과 고정 비용이 높음

### 2. 클라우드 (새로운 방식)
- 클라우드 컴퓨팅
  - 서버의 자원, 공간, 네트워크 환경 제공

  - 물리적 컴퓨터가 아닌 가상 컴퓨터(논리 컴퓨터)를 대여하며, 이는 가상화 기술의 발전에서 비롯

  - 가상화 기술 : 물리적 하드웨어를 논리적 객체로 추상화

- 장점
  - 필요할 때마다 컴퓨팅 능력을 유연하게 적용하여 사용한 만큼의 요금만 지급

  - 컴퓨터의 스냅샷(이미지)를 통해 다른 컴퓨터로 즉시 이주(migration) 가능

- 단점 : 운영 환경 자체가 클라우드 제공자에게 종속되어 버리므로, 클라우드 서비스에 문제가 생기면 내 환경에도 영향을 줌

### 3. 클라우드 서비스의 형태 3가지
- SaaS : Software as a Service (예시 : 오피스 365)
- PaaS : Platform as a Service (예시 : 드롭박스)
- IaaS : Infrastructure as a Service (가상 컴퓨터까지 제공하는 경우 대부분 IaaS)

<img width="500" alt="스크린샷 2021-09-16 오전 10 42 10" src="https://user-images.githubusercontent.com/80403988/133535890-c8f00e41-14c7-49bf-a378-a0c9b5aca5e0.png">

### 4. 대표적인 클라우드 서비스 
- 아마존 : Amazon Web Service
- 마이크로소프트 : Microsoft Azure
- 구글 : Google Cloud Platform

***

## 배포(Deployment)와 단계
- Deploy (소프트웨어 전개) : 프로그램 등을 서버와 같은 기기에 설치하여 서비스 등을 제공
- Distribute: 제품을 사용자들이 사용할 수 있도록 서비스 등을 제공하는 의미
- Release: 같은 제품을 새롭게 만드는 것(예: 새로운 버전을 배포, 새로운 아이피 번로 부여)

### 1. Development
- 각자의 컴퓨터 환경에서 개발 및 테스트

### 2. Integration
- 각자의 컴퓨터에서 작성한 코드 합치기
- 코드간 충돌을 확인하는 단계

### 3. Staging
- Production 단계와 가장 유사한 환경에서 테스트
- 모든 관계자들에게 검증하는 단계

### 4. Production
- 개발된 서비스를 출시하는 단계

***

## Amazon Web Service

### 1. AWS 서비스의 기본 용어
- AMI(Amazon Machine Image) : 소프트웨어 구성이 기재된 템플릿 (운영체제 + 애플리케이션)

- 리전(Region) : 지역별로 만들어 해당 region에 인스턴스를 묶음 (오하아오, 서울 region)

- 가용 영역 (Availability Zone) : region보다 작은 단위 (한국에는 서울, 부산에 있다고 함)

- 프라이빗 IP 주소 : 내부망에서 인스턴스에 접근할 때 private IP로 접근

- 퍼블릭 IP 주소 : 외부에서 인스턴스로 접근할 때 Public IP로 접근

- 보안 그룹 : 가상 컴퓨터에서 PORT/IP들을 허용하는 방화벽 프로그램
  - 80 : HTTP가 주로 사용하는 포트
  - 3306 : MySQL이 주로 사용하는 포트
  - 443 : HTTPS가 사용하는 포트
  - 22 : 작업을 위해 디폴트 옵션으로 열어둔 SSH를 위한 포트 (현업에서는 이렇게 하지 않고 내부망 사용)
  - EC2와 RDS는 보안 그룹을 설정했고, S3는 보안 그룹 설정 없이 Public 접근 여부만 설정

- 탄력적 IP 주소 (EIP)

### 2. EC2
- EC2 (Elastic Computer Cloud)
  - 아마존의 비용, 성능, 용량면에서 탄력적인 가상 컴퓨터를 한대 빌리는 것
  - PC방처럼 사용한 만큼 사용료 지불

- 이미지 : 템플릿 (OS, 애플리케이션)

- 인스턴스 : 아마존에시 대여하는 이미지가 적용되어 만들어진 가상(논리) 컴퓨터
  - 인스턴스 종료 : 인스턴스가 삭제됨
  - 인스턴스 종료 후 재시작 : IP 주소가 바뀜

- 인스턴스 유형 : 하드웨어임. 스펙 정의 

- 키 페어 : 비대칭 키 암호화 (SSH 프로토콜로 접속)

- 인스턴스 스토어 볼륨 : 인스턴스 자체에 내장된 임시 저장공간(HDD/SSD)으로 인스턴스 종료시 사라짐

- Amazon EBS(Elastic Block Store) : 인스턴스에 붙일 수 있는 저장공간(HDD/SSD)으로 인스턴스와 독립적으로 저장 가능

- Virtual Private Clouds(VPC) : 외부와 격리된 내부망으로 이 안에서 인스턴스끼리 통신함

- Elatic Load Balancer : EC2 사용에 필요
- Load Balancer : 여러 개의 컴퓨터에 트래픽 부하(load) 분산하는 시스템


### 3. RDS
- RDS (Relational Database Service) : AWS에서 제공하는 관계형 데이터베이스
- EC2에 MySQL을 설치하는 것이 아니라, MySQL에 접속하는 서비스
- EC2에서 MySQL을 설치하지 않고 RDS를 사용하는 이유는 하나의 컴퓨터에서 하나의 일만 하는 것이 좋기 때문
- 비용 문제로 RDS를 사용하기 싫다면 EC2를 2개 사용하여 서버와 데이터베이스를 분리하는 것도 하나의 대안

### 4. S3
- S3 (Simple Storage Service) : AWS에서 제공하는 클라우드 스토리지 서비스
  - 데이터를 무한히 저장 가능하고, 정적 웹 사이트 호스팅 가능 
  - 정적 파일 : 서버의 개입 없이 생성된 파일 / 동적 파일 : 서버가 요청에 맞추어 그 자리에서 생성한 파일
  - 웹 호스팅 : 서버의 한 공간을 빌려주어 웹 사이트의 배포와 운영이 가능하게 해주는 서비스이며 URL로 접근 가능
  - 버킷을 통한 웹 호스팅 가능

- 버킷 : S3에 저장되는 파일들이 담기는 바구니이며 파일을 저장하는 최상위 디렉토리 (저장 공간을 의미하는 AWS 용어)
- 객체 : 버킷이 담기는 파일 (키-값 페어 형식)로서 S3에 저장되는 객체는 파일과 메타데이터로 구성
- 메타데이터 : 객체의 생성일, 크기, 유형과 같은 객체에 대한 정보가 담긴 데이터

### 5. 기타 서비스
- lightsail, elastic beanstalk : EC2 쉽게 사용할 수 있게 하는 서비스
- lamba : serverless 마이크로서비스
- VPC : 그룹을 만들어 내부 DNS 및 IP로 통신하게 만듬
- CloudFront : CDN (정적 혹은 동적 웹페이지 배포하기 위한 전세계적 캐시서버)
- Cloud Front(CDN) 세팅 통한 HTTPS 사용 : cloudFront가 CDN 연결하며 http를 https로 변경하는 내부 기능 제공
- ACM : 인증서 관리
- Route R3 : 도메인 구입 및 관리, 도메인을 IP로 변경

### 6. 배포 전략
- 빌드 : 불필요한 데이터를 없애고, 여러 갈래로 퍼져있는 데이터들을 통합 및 압축하여 배포하기에 최적화된 상태를 만드는 것
- 웹 앱은 배포 가능한 정적 파일로 만들어야 함
- 리액트에서 정적 파일 형태로 결과물 만드는 명령어 : ```npm run build```

### 7. 추후 배포 단계 

- 중급 (HTTPS)
  - Route53을 통한 호스팅 영역 생성
  - CloudFront, ACM을 통해 SSL 인증서 발급 및 적용 (클라이언트 쪽)
  - Elastic Load Balancer, ACM을 통한 SSL 인증서 발급 및 적용 (서버 쪽)
  - Route53에 레코드 영역을 생성

- 고급
  - Docker, Jenkins 와 같은 오픈 소스 이용
  - Elastic Beanstalk 와 같은 다른 AWS 서비스 이용
  - 배포 자동화 파이프라인 구축
