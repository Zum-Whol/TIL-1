# URL, FS, CRUD (생활코딩 Node.js)

***

## URL의 이해
- 웹어서 1억 개의 정적 파일 보여줄려면 1억 개의 정적 파일이 있어야 함
- 같은 파일을 가지고 서로 다른 페이지를 만들어 보내기 : URL이 다름

### 1. URL의 형식

<img width="600" alt="스크린샷 2021-08-29 오후 10 59 54" src="https://user-images.githubusercontent.com/80403988/131253144-a4b0b794-8b63-4cec-a290-d281346bbeab.png">

- domain name : host라고도 부름

- port : 한 대의 컴퓨터 안에 여러 대의 서버가 있다면, port를 지정하여 어떤 서버와 통신할지 정해줌

- path : 컴퓨터 안에 어떤 디렉토리의 어떤 파일인지 가르킴

- query string : 쿼리 스트링의 값을 변경하면 웹 서버에게 특정 데이터 전달 가능
  - ? 로 시작
  - 값과 값은 & 으로 연결
  - 값의 이름과 값은 = 로 구분

### 2. Query string
- Query string의 값에 따라 Node.js로 만든 웹 서바가 사용자에게 동적으로 생성한 정보 전달
- URL의 Query string에 따라 사용자에게 다른 정보를 보여주기

### 3. URL 관련 문법
- request.url
  - 기능 : url에서 port 뒤의 값을 출력
  - 문법 : ```request.url```

- url.parse (url 모듈 사용)
  - 기능 : url에서 querystring과 path를 가져오기
  - url 모듈 가져오기 : ```let url = require('url')```
  - 공식 문법 : ```url.parse(urlStr, [parseQueryString], [slashesDenoteHost])```
  - Query String의 이름과 값을 객체로 출력 : ```url.parse(request.url, true).query```
    - true가 아니면 Query string을 url 문자열 그대로 출력)

***

## File System
- fs 모듈 가져오는 문법 : ```let fs = require('fs')```

### 1. fs.readfile
- 기능 : 파일의 내용을 읽어오기
- 문법 : ```fs.readFile(path[, options], callback)```
- 콜백함수의 전달인자 : err, data (data에 파일 내용이 string 타입으로 담김)

### 2. fs.readdir
- 기능 : 폴더에 있는 파일명을 배열의 엘리먼트로 담기
- 공식 문법 : ```fs.readFile(path[, options], callback)```
- 콜백함수의 전달인자 : err, files (files에는 파일명이 배열의 엘리먼트로 담김)

***

## CRUD

### 1. Read : Get 요청

- URL과 File Sytem을 통해 구현하기
  - url.parse 문법으로 URL의 쿼리스트링을 가져와 활용하기
  - fs.readfile 문법과 fs.readir 문법을 통해 파일 제목과 내용을 가져오기

```js
// 실제 코드에서 GET 요청과 관련된 부분만 요약하여 발췌

let template = {
    HTML:function(title, list, body, control){
      return `생략`;
    },
    list:function(filelist){
      var list = '<ul>';
      // 파일명과 URL의 쿼리스트링을 일치시키기
      list = list + `<li><a href="/?id=${filelist[i]}">${filelist[i]}</a></li>`; 
      list = list+'</ul>';
      return list;
    }
}

// 아래는 http.createServer(function(request,response){ 안의 내용

let _url = request.url;                       // url에서 port 뒷부분 출력
let queryData = url.parse(_url, true).query;  // 쿼리스트링 값만 출력하기

fs.readdir('./data', function(error, filelist){  // 파일 리스트 읽어오기
          // URL의 쿼리스트링에 부합하는 파일 내용을 불러오기
          fs.readFile(`data/${queryData.id}`, 'utf8', function(err, description){
            let title = queryData.id;
            let list = template.list(filelist);
            let html = template.HTML(title, list,
              `<h2>${title}</h2>${description}`,
            );
            response.writeHead(200);
            response.end(html);
          });
        }
```

### 2. Create : Post 요청
- input, textarea 태그만으로도 브라우저에서 양식을 만들 수 있지만, 서버로 데이터를 전송하려면 form 태그 필요

- form 엘리먼트
  - action 속성 : 데이터를 받아서 저장할 서버 주소 입력
  - method 속성 : HTTP 요청 종류를 입력

- form 엘리먼트에서 method 속성의 post 값
  - form을 전송하면 url에 쿼리스트링이 생성됨 (localhost:3000/process_create/?title=hi&description=hello)
  - 그러나 post 요청 전달되는 데이터가 url 주소에 포함되어 노출되는 것은 좋지 않음 (이걸로 유저가 서버 정보를 수정 가능)
  - form의 속성으로 method="post" 넣어주기 -> url에 전달되는 데이터가 url로 노출되지 않음

- input, textarea 엘리먼트
  - name 속성 : name 속성이 값이 있어야지 서버에서 데이터를 받았을 때 의미가 있음
  - placeholder 속성 : 양식의 입력란에 표시될 글자 넣기

```js
<form action="https://localhost:3000/process_create" method="post">
  <p><input type="text" name="title" placeholder="title"></p>
  <p><textarea name="description" placeholder="description"></textarea></p>
  <p><input type="submit"></p>
</form>
```

<img width="200" alt="스크린샷 2021-09-14 오후 11 04 50" src="https://user-images.githubusercontent.com/80403988/133275784-79252c8e-b987-415a-a277-75b3e5ec259d.png">

### 3. Update

### 4. Delete

