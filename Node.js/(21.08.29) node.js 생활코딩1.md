# Node.js 생활코딩1

## file system

```js
/* http://localhost:3000/path?id=value 를 주소창에 입력했을 때 id 값을 표시하기 위한 서버 구현 */

/* Data 폴더에는 파일명이 HTML, CSS, JavaScript인 파일이 이미 존재 */

var http = require('http');
var fs = require('fs');
let url = require('url'); // require은 node.js 모듈을 사용하는 키워드

var app = http.createServer(function(request,response){
    var _url = request.url;
    let queryData = url.parse(_url, true).query;
    let title = queryData.id;
    
    console.log(_url)          // /path?id=value
    console.log(queryData)     // { id: 'value' }
    console.log(queryData.id)  // value

  if(_url == '/'){
    title = 'Welcome';
  }
  if(_url == '/favicon.ico'){
    response.writeHead(404);
    response.end();
    return;

  }
  response.writeHead(200);
  fs.readFile(`data/${queryData.id}`, 'utf8', function(err, description){
    let template = `
    <!doctype html>
    <html>
    <head>
      <title>WEB1 - ${title}</title>
      <meta charset="utf-8">
    </head>
    <body>
      <h1><a href="/">WEB</a></h1>
      <ol>
        <li><a href="/?id=HTML">HTML</a></li>
        <li><a href="/?id=CSS">CSS</a></li>
        <li><a href="/?id=JavaScript">JavaScript</a></li>
      </ol>
      <h2>${title}</h2>
      <p>${description}</p>
    </body>
    </html>
    `;
    response.end(template);  
    })
});
app.listen(3000);
```



### 서버로 전송할 양식 만들기
- input, textarea 태그만으로도 브라우저상의 양식을 만들 수 있지만, 서버로 전송하려면 form 태그 필요

- form 태그
  - action 속성에 주소 입력 : 데이터를 받아서 저장할 서버 주소 입력

- input, textarea
  - name 속성이 있어야 서버에서 받았을 때 의미가 있음

- form을 전송하면 url에 쿼리스트링이 생성됨
- localhost:3000/process_create/?title=hi&description=hello
- 그러나 post 요청 전달되는 데이터가 url 주소에 포함/노출되는 것은 좋지 않음 (이걸로 서버 정보 수정 가능)
- form의 속성으로 method="post" 넣어주기 -> url에 전달되는 데이터가 노출되지 않음

```js
<form action="https://localhost:3000/process_create" method="post">
  <p><input type="text" name="title" placeholder="title"></p>
  <p><textarea name="description" placeholder="description"></textarea></p>
  <p><input type="submit"></p>
</form>
```

- 링크 url 통해 구현하는 것은 get 방식
```js
fs.readdir('./data', function(error, filelist){
        fs.readFile(`data/${queryData.id}`, 'utf8', function(err, description){
          var title = queryData.id;
          var list = templateList(filelist);
          var template = templateHTML(title, list,
            `<h2>${title}</h2>${description}`,
            `<a href="/create">create</a> 
             <a href="/update?id=${title}">update</a>
             <a href="/delete?id=${title}"">delete</a>`
          );
          response.writeHead(200);
          response.end(template);
        });
      });
```
- 삭제, update 등의 post 요청은 링크의 url 아닌 form을 사용해야 함

## 보안

### 사용자의 입력정보에 대한 보안
- 

### 파일 경로를 parse하기
- 파일 경로를 parse해서 url에 


### script 태그
- <script></script> 안에 있는 내용은 브라우저의 JavaScript로 실행됨
- 이 태그를 해커가 심을 수도 있음
